async function loadBitcoinData(){try{const e=window.innerWidth<=768;document.querySelector("#chart").innerHTML=`\n            <div style="display: flex; align-items: center; justify-content: center; height: ${e?"300px":"400px"}; color: #d1d5db;">\n                <div style="text-align: center;">\n                    <div style="border: 4px solid #374151; border-top: 4px solid #F7931A; border-radius: 50%; width: ${e?"30px":"40px"}; height: ${e?"30px":"40px"}; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>\n                    <p style="font-size: ${e?"12px":"14px"};">Loading historical chart data...</p>\n                </div>\n            </div>\n            <style>\n                @keyframes spin {\n                    0% { transform: rotate(0deg); }\n                    100% { transform: rotate(360deg); }\n                }\n            </style>\n        `;const o=await fetch("https://api.alternative.me/fng/?limit=0"),a=await o.json(),n=await fetch("https://min-api.cryptocompare.com/data/v2/histoday?fsym=BTC&tsym=USD&limit=2000"),i=await n.json();if("Error"===i.Response)throw new Error("Failed to fetch Bitcoin price data");const r=i.Data.Data;console.log(`Fetched ${a.data.length} Fear & Greed data points (all available data)`),console.log(`Fetched ${r.length} Bitcoin price points (last 5+ years)`);const l=new Map;a.data.forEach((t=>{const e=new Date(1e3*t.timestamp).toDateString();l.set(e,{value:parseInt(t.value),classification:t.value_classification})}));const s=[];function t(t){return t<=24?"#FF3B30":t<=49?"#FF9500":t<=59?"#FFCC00":t<=74?"#34C759":"#AEFC2E"}r.forEach((e=>{const o=new Date(1e3*e.time),a=o.toDateString(),n=l.get(a)||{value:50,classification:"Neutral"};s.push({x:o,y:Math.round(e.close),fngValue:n.value,classification:n.classification,color:t(n.value)})})),s.sort(((t,e)=>new Date(t.x)-new Date(e.x))),console.log(`Generated ${s.length} combined data points with historical Bitcoin price data`);const c={x:s.map((t=>t.x)),y:s.map((t=>t.y)),mode:"markers",type:"scatter",marker:{size:e?5:8,color:s.map((t=>t.fngValue)),colorscale:[[0,"#FF3B30"],[.25,"#FF9500"],[.5,"#FFCC00"],[.75,"#34C759"],[1,"#AEFC2F"]],cmin:0,cmax:100,colorbar:{title:{text:e?"F&G":"Fear & Greed Index",font:{color:"#d1d5db",size:e?10:14}},titleside:"right",tickmode:"array",tickvals:e?[0,25,50,75,100]:[0,20,40,60,80,100],ticktext:e?["0","25","50","75","100"]:["0","20","40","60","80","100"],tickfont:{color:"#d1d5db",size:e?8:12},len:e?.7:.9,thickness:e?12:20,x:e?1.01:1.02,bgcolor:"rgba(255,255,255,0.1)",bordercolor:"#374151",borderwidth:1,outlinecolor:"#d1d5db",outlinewidth:1},opacity:.8,line:{width:0}},hovertemplate:e?"<b>%{text}</b><br>BTC: <b>$%{y:,.0f}</b><br>F&G: <b>%{customdata[0]}</b><br><extra></extra>":"<b>%{text}</b><br>Bitcoin Price: <b>$%{y:,.0f}</b><br>Fear & Greed: <b>%{customdata[0]}</b> (%{customdata[1]})<br><extra></extra>",text:s.map((t=>t.x.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}))),customdata:s.map((t=>[t.fngValue,t.classification])),name:"Bitcoin Price vs Fear & Greed"},d={title:{text:"",font:{color:"#d1d5db",size:16}},xaxis:{title:{text:"",font:{color:"#d1d5db",size:e?10:12}},color:"#d1d5db",gridcolor:"#374151",tickfont:{color:"#d1d5db",size:e?9:11},showgrid:!0,type:"date",zeroline:!1,showline:!0,linecolor:"#374151"},yaxis:{title:{text:e?"BTC Price":"Bitcoin Price (USD)",font:{color:"#F7931A",size:e?11:14}},color:"#d1d5db",gridcolor:"#374151",tickfont:{color:"#d1d5db",size:e?9:11},showgrid:!0,type:"log",zeroline:!1,showline:!0,linecolor:"#374151",tickmode:"array",tickvals:[1e3,2e3,5e3,1e4,2e4,5e4,1e5],ticktext:["$1K","$2K","$5K","$10K","$20K","$50K","$100K"],range:[Math.log10(4300),Math.log10(12e4)],ticklen:6,tickwidth:1,tickcolor:"#374151"},plot_bgcolor:"rgba(0,0,0,0.1)",paper_bgcolor:"transparent",font:{color:"#d1d5db",family:"Inter, sans-serif"},margin:{l:e?50:90,r:e?60:140,t:e?30:50,b:e?40:60},showlegend:!1,hovermode:"closest",dragmode:"zoom"},p={displayModeBar:!1,displaylogo:!1,responsive:!0};document.querySelector("#chart").innerHTML="",Plotly.newPlot("chart",[c],d,p);const h=document.querySelector("#chart"),u=`\n            <div class="time-range-dropdown" style="position: absolute; top: ${e?"5px":"10px"}; right: ${e?"5px":"10px"}; z-index: 1000;">\n                <select id="timeRangeSelector" style="\n                    background: rgba(0,0,0,0.1); \n                    color: #d1d5db; \n                    border: 1px solid #374151; \n                    border-radius: ${e?"4px":"6px"}; \n                    padding: ${e?"4px 8px":"8px 12px"}; \n                    font-size: ${e?"10px":"12px"};\n                    font-family: Inter, sans-serif;\n                    outline: none;\n                    cursor: pointer;\n                    backdrop-filter: blur(10px);\n                    -webkit-backdrop-filter: blur(10px);\n                ">\n                    <option value="7">${e?"7D":"7 Days"}</option>\n                    <option value="30">${e?"30D":"30 Days"}</option>\n                    <option value="90">${e?"3M":"3 Months"}</option>\n                    <option value="180">${e?"6M":"6 Months"}</option>\n                    <option value="365">${e?"1Y":"1 Year"}</option>\n                    <option value="all" selected>${e?"All":"All Data"}</option>\n                </select>\n            </div>\n        `;h.style.position="relative",h.insertAdjacentHTML("afterbegin",u),document.getElementById("timeRangeSelector").addEventListener("change",(function(t){const e=t.target.value;let o,a=new Date;o="all"===e?new Date(Math.min(...s.map((t=>t.x)))):new Date(Date.now()-24*parseInt(e)*60*60*1e3);const n=s.filter((t=>t.x>=o&&t.x<=a));if(n.length>0){const t=Math.min(...n.map((t=>t.y))),i=Math.max(...n.map((t=>t.y))),r=.1*(i-t);let l;l="all"===e?4300:Math.max(1,t-r);const s=i+r,c=8,d=[],p=[];if("all"===e){const t=Math.log10(l),e=(Math.log10(s)-t)/(c-1);for(let o=0;o<c;o++){const a=t+o*e;let n=Math.pow(10,a);n=n<1e4?1e3*Math.round(n/1e3):n<1e5?5e3*Math.round(n/5e3):1e4*Math.round(n/1e4),d.push(n),n>=1e4||n>=1e3?p.push(`$${(n/1e3).toFixed(0)}K`):p.push(`$${n.toFixed(0)}`)}}else if(s/l>100){const t=Math.log10(l),e=(Math.log10(s)-t)/(c-1);for(let o=0;o<c;o++){const a=t+o*e,n=Math.pow(10,a);d.push(n),n>=1e4?p.push(`$${(n/1e3).toFixed(0)}K`):n>=1e3?p.push(`$${(n/1e3).toFixed(1)}K`):p.push(`$${n.toFixed(0)}`)}}else{const t=(s-l)/(c-1);for(let e=0;e<c;e++){const o=l+e*t;d.push(o),o>=1e4?p.push(`$${(o/1e3).toFixed(0)}K`):o>=1e3?p.push(`$${(o/1e3).toFixed(1)}K`):p.push(`$${o.toFixed(0)}`)}}const h={"xaxis.range":[o,a],"yaxis.range":[Math.log10(l),Math.log10(s)],"yaxis.tickvals":d,"yaxis.ticktext":p,"yaxis.tickmode":"array"};Plotly.relayout("chart",h)}}));const x=new Date(Math.min(...s.map((t=>t.x)))),m=new Date;setTimeout((()=>{const t=s.filter((t=>t.x>=x&&t.x<=m));if(t.length>0){const e=Math.min(...t.map((t=>t.y))),o=Math.max(...t.map((t=>t.y))),a=4300,n=o+.1*(o-e),i=8,r=[],l=[],s=Math.log10(a),c=(Math.log10(n)-s)/(i-1);for(let t=0;t<i;t++){const e=s+t*c;let o=Math.pow(10,e);o=o<1e4?1e3*Math.round(o/1e3):o<1e5?5e3*Math.round(o/5e3):1e4*Math.round(o/1e4),r.push(o),o>=1e4||o>=1e3?l.push(`$${(o/1e3).toFixed(0)}K`):l.push(`$${o.toFixed(0)}`)}Plotly.relayout("chart",{"xaxis.range":[x,m],"yaxis.range":[Math.log10(a),Math.log10(n)],"yaxis.tickvals":r,"yaxis.ticktext":l,"yaxis.tickmode":"array"})}}),100),document.querySelector("#full-screen").addEventListener("click",(function(){const t=document.querySelector("#chart");t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()})),console.log("Chart successfully loaded with historical Bitcoin price data from CryptoCompare")}catch(g){console.error("Error loading Bitcoin historical data:",g),document.querySelector("#chart").innerHTML='\n            <div style="display: flex; align-items: center; justify-content: center; height: 400px; color: #d1d5db; flex-direction: column;">\n                <svg width="48" height="48" fill="currentColor" viewBox="0 0 20 20" style="margin-bottom: 16px; opacity: 0.7;">\n                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>\n                </svg>\n                <p style="text-align: center; font-size: 16px; margin-bottom: 8px; font-weight: 600;">Unable to load chart data</p>\n                <p style="text-align: center; font-size: 14px; opacity: 0.7; margin-bottom: 16px;">Failed to fetch historical data. Please try again.</p>\n                <button onclick="loadBitcoinData()" style="padding: 10px 20px; background: #F7931A; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background-color 0.2s;">\n                    Retry Loading\n                </button>\n            </div>\n        '}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",loadBitcoinData):loadBitcoinData(),window.addEventListener("resize",(function(){clearTimeout(window.resizeTimer),window.resizeTimer=setTimeout((function(){loadBitcoinData()}),250)}));